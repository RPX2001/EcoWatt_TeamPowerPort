# Frontend justfile for EcoWatt project

# Default recipe - show available commands
default:
    @just --list

# Install dependencies
install:
    npm install

# Start development server
dev:
    npm run dev

# Build for production (outputs to ../flask/static/frontend)
build:
    npm run build

# Preview production build
preview:
    npm run preview

# Run all tests
test:
    npm run test

# Run tests in watch mode
test-watch:
    npm run test:watch

# Run tests with UI
test-ui:
    npm run test:ui

# Run tests with coverage
test-coverage:
    npm run test:coverage

# Open Cypress for E2E testing
cypress:
    npm run cypress:open

# Run Cypress tests headless
cypress-run:
    npm run cypress:run

# Run linter
lint:
    npm run lint

# Fix linting issues
lint-fix:
    npm run lint:fix

# Format code with Prettier
format:
    npm run format

# Check code formatting
format-check:
    npm run format:check

# Check if Flask backend is running
check-backend:
    @echo "Testing Flask backend connection..."
    @curl -s http://localhost:5001/health || echo "âŒ Flask backend not running on port 5001"

# Full stack check (Flask + Frontend)
fullstack-check:
    @echo "ğŸ” Checking full stack status..."
    @echo "\n1. Flask Backend:"
    @curl -s http://localhost:5001/health && echo "âœ… Backend is running" || echo "âŒ Backend not running"
    @echo "\n2. Frontend Dev Server:"
    @curl -s http://localhost:5173 > /dev/null 2>&1 && echo "âœ… Frontend is running" || echo "âŒ Frontend not running"

# Clean node_modules and reinstall
clean-install:
    rm -rf node_modules package-lock.json
    npm install

# Clean build artifacts
clean:
    rm -rf dist ../flask/static/frontend

# Full clean and rebuild
rebuild: clean-install build
